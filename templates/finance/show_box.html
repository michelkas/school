{% extends "base.html" %}

{% block content %}
    {% include "includes/nav_bar_finance.html" %}
    <section class="container py-4">
        
        <div class="row justify-content-center">
            {% for frais, mois_dict in groupe_frais.items %}
                {% for mois, infos in mois_dict.items %}
                    {% for info in infos %}
                        <div class="col-md-8 col-lg-6 mb-4">
                            <div class="card shadow-sm border-0">
                                <div class="card-header bg-info text-white">
                                    <h5 class="mb-0"  >{{ frais|capfirst}}</h5>
                                </div>
                                <div class="card-body bg-light">
                                    <div class="mb-2"><span class="fw-bold text-secondary">Montant Frais :</span> <span class="badge bg-success">{{ info.fees_mount|floatformat:0 }} FC</span></div>
                                        
                                    <div class="mb-2"><span class="fw-bold text-secondary">Mois :</span> <span class="badge bg-primary text-white">{% if info.months == 1 %}Septembre{% elif info.months == 2 %}Octobre{% elif info.months == 3 %}Novembre{% elif info.months == 4 %}Décembre{% elif info.months == 5 %}Janvier{% elif info.months == 6 %}Février{% elif info.months == 7 %}Mars{% elif info.months == 8 %}Avril{% elif info.months == 9 %}Mai{% elif info.months == 10 %}Juin{% else %}{{ info.months }}{% endif %}</span></div>
                                    <div class="mb-2"><span class="fw-bold text-secondary">Détails paiement :</span></div>
                                    <ul class="list-group list-group-flush mb-2">
                                        {% for paiement in info.details_paiement %}
                                            <li class="list-group-item">
                                                -le <span class="text-primary">{{ paiement.date }}</span> paye <span class="fw-bold">{{ paiement.montant|floatformat:0 }} FC</span>
                                                <a href="{% url 'finance:edit_payment' paiement.payment_id %}" class="btn btn-sm btn-outline-danger ms-2" title="Modifier le paiement">
                                                    <i class="bi bi-pencil-square"></i>
                                                </a>
                                                <!-- Bouton d'impression du reçu -->
                                                <a href="{% url 'finance:print_receipt' paiement.payment_id %}" onclick="window.open(this.href, '_blank', 'width=600,height=800'); return false;" class="btn btn-sm btn-outline-primary ms-2" title="Imprimer le reçu">
                                                    <i class="bi bi-printer"></i> Imprimer
                                                </a>
                                            </li>
                                        {% endfor %}
                                
                                    <div class="mb-2"><span class="fw-bold text-secondary">Statut :</span></div>
                                    <ul class="list-group list-group-flush">
                                        <li class="list-group-item">Dette : <span class="fw-bold text-danger">{{ info.dette|floatformat:0 }}</span></li>
                                        <li class="list-group-item">Total payé : <span class="fw-bold text-success">{{ info.total|floatformat:0 }}</span></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                {% endfor %}
            {% endfor %}
        </div>
    </section>
{% endblock  %}

